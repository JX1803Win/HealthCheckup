<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- mapper动态代理： namespace 的值要等于 UserDao 接口的地址（包名.接口名） -->
<mapper namespace="org.xmgreat.mapper.PermissionsMapper">
	
	<!-- 查询登录账户权限 -->
	<select id="selectRoleInfo"
		resultMap="PermissionsInf" parameterType="int">
		select * from tblPermissionsInf tpi,tblRolePermissions trp where
		trp.permissionsId=tpi.permissionsId and trp.roleId=#{roleId}
	</select>
	<resultMap type="org.xmgreat.bean.PermissionsInfBean" id="PermissionsInf">
		<id property="permissionsId" column="permissionsId" />
		<result property="menuName" column="menuName" />
		<result property="preMenu" column="preMenu" />
		<result property="urlAddress" column="urlAddress" />
		<result property="orderNo" column="orderNo" />
			
		<association property="rolePermissionsBean" column="permissionsId"
			javaType="org.xmgreat.bean.RolePermissionsBean">
			<id property="permissionsId" column="permissionsId" />
			<result property="roleId" column="roleId" />
		</association>
	</resultMap>
	<!-- 查询角色的数量 -->
	<select id="getRoleNum"  resultType="int" >
	  select count(*) from tblRole where 1=1
	 <if test="roleName!=null and roleName != ''">
	     and roleName like concat(concat('%',#{roleName}),'%')
	 </if>
	</select>
	<!-- 查询所有角色 -->
	<select id="selectAllRoleInfo" resultType="org.xmgreat.bean.RoleBean" >
		
		select z.* from (select a.* , rownum rn from tblRole a  where 1=1 
		  <if test="roleName!=null and roleName != ''">
	     and roleName like concat(concat('%',#{roleName}),'%')
	    </if>  
	    and rownum &lt; (#{pageNo} * 3 + 1)) z  where z.rn &gt;((#{pageNo} - 1) * 3)
	</select>
	
</mapper>